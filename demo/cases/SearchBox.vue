<template>
    <article class="veui-search-box-demo">
        <h1><code>&lt;veui-search-box&gt;</code></h1>
        <veui-form>
            <section class="has-margin-right">
                <h2>é£æ ¼</h2>
                <div class="options-desc">
                    å¯é€‰çš„é£æ ¼ <span class="bg-gray-show">ui</span> 
                    å±æ€§å€¼ï¼š <span class="bg-gray-show">normal / strong</span>
                </div>
                <section>
                    <veui-field
                        label="normal"
                    >
                        <veui-search-box
                            placeholder="normal"
                            clearable
                            :suggestions="suggestions4"
                            @input="handleSuggest('4', $event)"
                            @search="log($event)"
                            @select="log('select', $event)"
                        />
                    </veui-field>
                    <veui-field
                        label="strong"
                    >
                        <veui-search-box
                            ui="strong"
                            clearable
                            placeholder="strong"
                            :suggestions="suggestions4"
                            @input="handleSuggest('4', $event)"
                            @search="log($event)"
                            @select="log('select', $event)"
                        />
                    </veui-field>
                </section>
                <h2>å°ºå¯¸</h2>
                <div class="options-desc">
                    å¯é€‰çš„å°ºå¯¸ <span class="bg-gray-show">ui</span> 
                    å±æ€§å€¼ï¼š <span class="bg-gray-show">xs / s / m / l</span>
                </div>
                <section>
                    <veui-field
                        ui="micro"
                        label="è¶…å°å·ï¼ˆxsï¼‰"
                    >
                        <veui-search-box
                            ui="xs"
                            placeholder="xs"
                            :suggestions="suggestions4"
                            @input="handleSuggest('4', $event)"
                            @search="log($event)"
                            @select="log('select', $event)"
                        />
                        <veui-search-box
                            ui="xs strong"
                            placeholder="xs strong"
                            :suggestions="suggestions4"
                            @input="handleSuggest('4', $event)"
                            @search="log($event)"
                            @select="log('select', $event)"
                        />
                    </veui-field>
                    <veui-field
                        ui="micro"
                        label="å°å·ï¼ˆsï¼‰"
                    >
                        <veui-search-box
                            ui="s"
                            placeholder="s"
                            :suggestions="suggestions4"
                            @input="handleSuggest('4', $event)"
                            @search="log($event)"
                            @select="log('select', $event)"
                        />
                        <veui-search-box
                            ui="s strong"
                            placeholder="s strong"
                            :suggestions="suggestions4"
                            @input="handleSuggest('4', $event)"
                            @search="log($event)"
                            @select="log('select', $event)"
                        />
                    </veui-field>
                    <veui-field
                        ui="micro"
                        label="ä¸­å·ï¼ˆmï¼‰"
                    >
                        <veui-search-box
                            ui="m"
                            placeholder="m"
                            :suggestions="suggestions4"
                            @input="handleSuggest('4', $event)"
                            @search="log($event)"
                            @select="log('select', $event)"
                        />
                        <veui-search-box
                            ui="m strong"
                            placeholder="m strong"
                            :suggestions="suggestions4"
                            @input="handleSuggest('4', $event)"
                            @search="log($event)"
                            @select="log('select', $event)"
                        />
                    </veui-field>
                    <veui-field
                        ui="micro"
                        label="å¤§å·ï¼ˆlï¼‰"
                    >
                        <veui-search-box
                            ui="l"
                            placeholder="l"
                            :suggestions="suggestions4"
                            @input="handleSuggest('4', $event)"
                            @search="log($event)"
                            @select="log('select', $event)"
                        />
                        <veui-search-box
                            ui="l strong"
                            placeholder="l strong"
                            :suggestions="suggestions4"
                            @input="handleSuggest('4', $event)"
                            @search="log($event)"
                            @select="log('select', $event)"
                        />
                    </veui-field>
                </section>
            </section>
            <section class="has-margin-right">
                <h2>disabled</h2>
                <section>
                    <veui-search-box
                        :value="value"
                        clearable
                        placeholder="disabled"
                        disabled
                        @search="log($event)"
                    />
                    <veui-search-box
                        ui="strong"
                        disabled
                        placeholder="strong disabled"
                        :suggestions="suggestions5"
                        @input="handleSuggest('5', $event)"
                        @search="log($event)"
                    />
                </section>
            </section>
            <section class="has-margin-right">
                <h2>readonly</h2>
                <section>
                    <veui-search-box
                        :value="value"
                        clearable
                        placeholder="readonly"
                        readonly
                        @search="log($event)"
                    />
                    <veui-search-box
                        :value="value"
                        clearable
                        ui="strong"
                        placeholder="strong readonly"
                        readonly
                        @search="log($event)"
                    />
                </section>
            </section>
            <section class="has-margin-right">
                <h2>suggestions</h2>
                <section>
                    <veui-search-box
                        v-model="value2"
                        clearable
                        :placeholder="placeholder"
                        :suggestions="suggestions1"
                        suggest-trigger="focus"
                        @suggest="asyncHandleSuggest('1', $event)"
                        @search="log($event)"
                        @select="value2 = $event.label"
                    />
                    <veui-search-box
                        :placeholder="placeholder"
                        :suggestions="suggestions8"
                        suggest-trigger="focus"
                        @search="log($event)"
                        @suggest="suggestHandler"
                    >
                        <template
                            slot="suggestion"
                            slot-scope="suggestion"
                        >
                            <span>{{ suggestion.value }}</span>
                            <veui-icon name="eye"/>
                        </template>
                    </veui-search-box>
                    <veui-search-box
                        :placeholder="placeholder"
                        :suggestions="suggestions9"
                        replace-on-select
                        @input="handleSuggest('7', $event)"
                        @search="log($event)"
                    >
                        <template slot="suggestions-before">
                            <h3>header</h3>
                        </template>
                        <template
                            slot="group-label"
                            slot-scope="{ label }"
                        >
                            1ğŸ‘‰ {{ label }}
                        </template>
                        <template
                            slot="option-label"
                            slot-scope="{ label }"
                        >
                            2ğŸ‘‰ {{ label }}
                        </template>
                        <template slot="suggestions-after">
                            <h3>ender</h3>
                        </template>
                    </veui-search-box>
                </section>
            </section>
        </veui-form>
    </article>
</template>

<script>
import bus from '../bus';
import {includes} from 'lodash';
import {SearchBox, Icon, Form, Field} from 'veui';
import 'vue-awesome/icons/flag';

export default {
    name: 'demo-search-box',
    components: {
        'veui-search-box': SearchBox,
        'veui-icon': Icon,
        'veui-field': Field,
        'veui-form': Form
    },
    data() {
        return {
            name: 'name',
            value: '',
            value2: null,
            value3: 'æµ‹è¯•å€¼',
            value4: 'æµ‹è¯•å€¼',
            valueis: 'æµ‹è¯•å€¼',
            placeholder: 'ç™¾åº¦(placeholder)',
            suggestions1: [],
            suggestions2: [],
            suggestions3: [],
            suggestions4: [],
            suggestions5: [],
            suggestions8: [
                {
                    value: 'ç™¾åº¦',
                    label: 'ç™¾åº¦'
                },
                {
                    value: 'ç™¾åº¦è´´å§',
                    label: 'ç™¾åº¦è´´å§'
                },
                {
                    value: 'ç™¾åº¦MVP',
                    label: 'ç™¾åº¦MVP'
                }
            ],
            suggestions9: [
                {
                    label: 'æ±½è½¦',
                    options: [
                        {label: 'camry', value: 'camry'},
                        {label: 'carola', value: 'carola'}
                    ]
                }
            ],
        };
    },
    methods: {
        handleSuggest(num, value) {
            if (value && num) {
                this[`suggestions${num}`] = [
                    {
                        value,
                        label: value
                    },
                    {
                        value: 'ç™¾åº¦',
                        label: 'ç™¾åº¦'
                    },
                    {
                        value: 'ç™¾åº¦è´´å§',
                        label: 'ç™¾åº¦è´´å§'
                    },
                    {
                        value: 'ç™¾åº¦MVP',
                        label: 'ç™¾åº¦MVP'
                    }
                ];
            } else {
                this[`suggestions${num}`] = [
                    '',
                    'ç™¾åº¦',
                    'ç™¾åº¦è´´å§',
                    'ç™¾åº¦MVP',
                    'ç™¾åº¦æŒ‡æ•°'
                ];
            }
        },
        asyncHandleSuggest(num, value) {
            setTimeout(() => {
                if (value && num < 3) {
                    this[`suggestions${num}`] = [
                        {
                            value,
                            label: value
                        },
                        {
                            value: 'ç™¾åº¦',
                            label: 'ç™¾åº¦'
                        },
                        {
                            value: 'ç™¾åº¦è´´å§',
                            label: 'ç™¾åº¦è´´å§'
                        },
                        {
                            value: 'ç™¾åº¦MVP',
                            label: 'ç™¾åº¦MVP'
                        }
                    ];
                } else {
                    this[`suggestions${num}`] = [
                        '',
                        'ç™¾åº¦',
                        'ç™¾åº¦è´´å§',
                        'ç™¾åº¦MVP',
                        'ç™¾åº¦æŒ‡æ•°'
                    ];
                }
            }, 1000);
        },
        log(item) {
            bus.$emit('log', item);
        },
        suggestHandler(value) {
            this.suggestions8 = this.suggestions8.map(item => {
                item.hidden = !(
                    includes(item.label, value) || includes(item.value, value)
                );
                return item;
            });
        }
    }
};
</script>
<style lang="less">
.veui-search-box-demo {
    padding-bottom: 20px;

    .has-margin-right {
        .veui-search-box {
        margin-right: 15px;
        }
    }
    .veui-field {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
    }

}

section {
  & & {
    margin-bottom: 20px;
  }
}
</style>
